{% include "header.html" %}
<div class="container mt-5">
    <h1>Crop Picture</h1>
    
    <div class="row">
        <div class="col-md-8">
            <div id="image-container">
                <img id="image" src="{{ url_for('static', filename=picture.original_path) }}" alt="Upload">
            </div>
        </div>
        <div class="col-md-4">
            <form id="crop-form" method="post">
                <input type="hidden" name="x" id="crop-x">
                <input type="hidden" name="y" id="crop-y">
                <input type="hidden" name="width" id="crop-width">
                <input type="hidden" name="height" id="crop-height">
                <button type="submit" class="btn btn-primary">Save Crop</button>
            </form>
        </div>
    </div>
</div>

<!-- Include Cropper.js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const image = document.getElementById('image');
    const cropForm = document.getElementById('crop-form');
    
    const cropper = new Cropper(image, {
        aspectRatio: 1, // 1:1 aspect ratio
        viewMode: 1,
        crop(event) {
            document.getElementById('crop-x').value = event.detail.x;
            document.getElementById('crop-y').value = event.detail.y;
            document.getElementById('crop-width').value = event.detail.width;
            document.getElementById('crop-height').value = event.detail.height;
        }
    });
});
</script>

<style>
#image-container {
    max-width: 100%;
    height: 500px;
}
#image {
    max-width: 100%;
    max-height: 100%;
}
</style>
{% include "footer.html" %}